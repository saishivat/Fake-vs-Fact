<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Fake vs Fact / Then vs Now Generator</title>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      background-color: #f5f5f5;
    }

    input[type="file"] {
      display: none;
    }

    .custom-upload {
      background: #007BFF;
      color: white;
      padding: 10px 20px;
      margin: 10px;
      border-radius: 4px;
      cursor: pointer;
      display: inline-block;
    }

    input[type="text"], button {
      margin: 10px;
      padding: 10px;
    }

    .upload-status {
      color: green;
      font-weight: bold;
    }

    .preview {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin: 20px;
    }

    .img-container {
      position: relative;
      text-align: center;
    }

    .img-container img {
      max-width: 300px;
      border: 2px solid #ccc;
    }

    .img-container h2 {
      margin: 5px 0;
      padding: 5px;
      color: white;
    }

    .watermark {
      position: absolute;
      top: 40%;
      left: -60px;
      transform: rotate(-45deg);
      font-size: 60px;
      color: rgba(255, 0, 0, 0.3);
      font-weight: bold;
      width: 500px;
      text-align: center;
      pointer-events: none;
      z-index: 10;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    }

    #result img {
      max-width: 90%;
      margin-top: 20px;
      border: 2px solid #000;
    }

    .center-handle {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255,255,255,0.8);
      padding: 5px 10px;
      border-radius: 5px;
      font-weight: bold;
      z-index: 20;
    }
  </style>
</head>
<body>

  <h1>Fake vs Fact / Then vs Now Image Template</h1>

  <label class="custom-upload">Upload Left Image
    <input type="file" id="leftInput" accept="image/*" onchange="handleUpload('leftInput', true, 'leftUploaded')">
  </label>
  <span id="leftUploaded" class="upload-status"></span>

  <label class="custom-upload">Upload Right Image
    <input type="file" id="rightInput" accept="image/*" onchange="handleUpload('rightInput', false, 'rightUploaded')">
  </label>
  <span id="rightUploaded" class="upload-status"></span>

  <br>
  <input type="text" id="twitterHandle" placeholder="Enter Twitter handle (e.g. @yourhandle)">
  
  <div style="margin: 20px 0;">
    <label><input type="radio" name="mode" value="factFake" checked> Fake vs Fact</label>
    <label style="margin-left: 20px;"><input type="radio" name="mode" value="thenNow"> Then vs Now</label>
  </div>

  <button onclick="generateImage()">Generate Combined Image</button>

  <div class="preview">
    <div class="img-container">
      <h2 id="leftHeading" style="background-color:red;">Fake</h2>
      <img id="leftPreview">
    </div>
    <div class="img-container">
      <h2 id="rightHeading" style="background-color:green;">Fact</h2>
      <img id="rightPreview">
    </div>
  </div>

  <div id="result"></div>

  <script>
    let leftImageSrc = "";
    let rightImageSrc = "";

    function handleUpload(inputId, isLeft, statusId) {
      const fileInput = document.getElementById(inputId);
      const file = fileInput.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function (e) {
        if (isLeft) {
          leftImageSrc = e.target.result;
          document.getElementById("leftPreview").src = leftImageSrc;
        } else {
          rightImageSrc = e.target.result;
          document.getElementById("rightPreview").src = rightImageSrc;
        }
        document.getElementById(statusId).innerText = "âœ“ Uploaded!";
        updatePreviewLabels();
      };
      reader.readAsDataURL(file);
    }

    function updatePreviewLabels() {
      const mode = document.querySelector('input[name="mode"]:checked').value;
      const leftHeading = document.getElementById("leftHeading");
      const rightHeading = document.getElementById("rightHeading");

      if (mode === "factFake") {
        leftHeading.textContent = "Fake";
        rightHeading.textContent = "Fact";
        leftHeading.style.backgroundColor = "red";
        rightHeading.style.backgroundColor = "green";
      } else {
        leftHeading.textContent = "Then";
        rightHeading.textContent = "Now";
        leftHeading.style.backgroundColor = "gray";
        rightHeading.style.backgroundColor = "gray";
      }
    }

    document.querySelectorAll('input[name="mode"]').forEach(radio => {
      radio.addEventListener('change', updatePreviewLabels);
    });

    function generateImage() {
      const mode = document.querySelector('input[name="mode"]:checked').value;
      const twitterHandle = document.getElementById("twitterHandle").value.trim();

      if (!leftImageSrc || !rightImageSrc) {
        alert("Please upload both images.");
        return;
      }

      const wrapper = document.createElement("div");
      wrapper.style.position = "relative";
      wrapper.style.display = "flex";
      wrapper.style.width = "640px";
      wrapper.style.margin = "0 auto";
      wrapper.style.background = "white";
      wrapper.style.gap = "20px";

      let leftLabel = "", rightLabel = "", color = "", addWatermark = false;

      if (mode === "factFake") {
        leftLabel = "Fake";
        rightLabel = "Fact";
        color = ["red", "green"];
        addWatermark = true;
      } else {
        leftLabel = "Then";
        rightLabel = "Now";
        color = ["gray", "gray"];
        addWatermark = false;
      }

      const box1 = createImageBox(leftImageSrc, leftLabel, color[0], addWatermark);
      const box2 = createImageBox(rightImageSrc, rightLabel, color[1], false);

      wrapper.appendChild(box1);
      wrapper.appendChild(box2);

      if (twitterHandle) {
        const handleMark = document.createElement("div");
        handleMark.textContent = twitterHandle;
        handleMark.className = "center-handle";
        wrapper.appendChild(handleMark);
      }

      document.body.appendChild(wrapper);

      setTimeout(() => {
        html2canvas(wrapper).then(canvas => {
          document.body.removeChild(wrapper);
          const result = document.getElementById("result");
          result.innerHTML = "";
          result.appendChild(canvas);

          const link = document.createElement("a");
          link.textContent = "Download Combined Image";
          link.style.display = "block";
          link.style.margin = "20px auto";
          link.style.fontSize = "18px";
          link.style.color = "#007BFF";
          link.style.cursor = "pointer";

          link.onclick = () => {
            const a = document.createElement("a");
            a.href = canvas.toDataURL("image/png");
            a.download = mode === "factFake" ? "fake_vs_fact.png" : "then_vs_now.png";
            a.click();
          };

          result.appendChild(link);
        });
      }, 500);
    }

    function createImageBox(src, label, bgColor, addWatermark) {
      const box = document.createElement("div");
      box.style.position = "relative";
      box.style.textAlign = "center";

      const heading = document.createElement("h2");
      heading.textContent = label;
      heading.style.backgroundColor = bgColor;
      heading.style.color = "white";
      heading.style.margin = "0";
      heading.style.padding = "5px";

      const img = document.createElement("img");
      img.src = src;
      img.style.maxWidth = "300px";
      img.style.marginTop = "5px";

      box.appendChild(heading);
      box.appendChild(img);

      if (addWatermark) {
        const wm = document.createElement("div");
        wm.className = "watermark";
        wm.textContent = "FAKE NEWS";
        box.appendChild(wm);
      }

      return box;
    }
  </script>

</body>
</html>
